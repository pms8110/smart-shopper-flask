{% set is_favorite = item.content in current_user.favorite_items.all()|map(attribute='content') %}

<li class="collection-item" id="item-{{ item.id }}">
    <label>
        <input type="checkbox" class="filled-in toggle-item" data-item-id="{{ item.id }}" {% if item.completed %}checked{% endif %}>
        <span class="item-content {% if item.completed %}completed{% endif %}">{{ item.content }}</span>
        {% if item.quantity > 1 or item.unit %}
            <span class="grey-text"> ({{ item.quantity }} {{ item.unit or '' }})</span>
        {% endif %}
    </label>
    <div class="secondary-content">
        <!-- <<< تغییر جدید: افزودن کلاس action-icon به لینک‌ها >>> -->
        <a href="#" class="toggle-favorite-btn tooltipped action-icon" data-item-id="{{ item.id }}" data-position="top" data-tooltip="{{ _('Toggle Favorite') }}">
            <i class="material-icons star-icon {% if is_favorite %}yellow-text text-darken-2{% else %}grey-text text-lighten-1{% endif %}">star</i>
        </a>
        <a href="#" class="edit-item-trigger action-icon" data-item-id="{{ item.id }}">
            <i class="material-icons grey-text text-darken-1">edit</i>
        </a>
        <a href="#" class="delete-item action-icon" data-item-id="{{ item.id }}">
            <i class="material-icons red-text text-lighten-1">delete</i>
        </a>
    </div>
</li>
